{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "dependencyDashboard": true,
  "timezone": "UTC",
  "schedule": [],
  "labels": ["dependencies", "renovate", "shared-assets"],

  "npm": { "enabled": true },
  "github-actions": { "enabled": true },

  "packageRules": [
    {
      "description": "Pin ansible-core to 2.18.x across workflow templates",
      "matchPackageNames": ["ansible-core"],
      "allowedVersions": "/^2\\.18\\./",
      "groupName": "ansible-core (2.18.x only)"
    },
    {
      "description": "Pin ansible-lint to 6.22.x (keeps templates compatible with current tooling)",
      "matchPackageNames": ["ansible-lint"],
      "allowedVersions": "/^6\\.22\\./",
      "groupName": "ansible-lint (6.22.x only)"
    },
    {
      "description": "Pin Python to 3.11.x in workflow templates",
      "matchPackageNames": ["python"],
      "allowedVersions": "/^3\\.11\\./",
      "groupName": "python (3.11.x only)"
    },
    {
      "matchManagers": ["npm"],
      "groupName": "npm dependencies"
    },
    {
      "groupName": "semantic-release toolchain",
      "description": "Keep semantic-release and its plugins in sync across all template repos",
      "matchManagers": ["npm"],
      "matchPackageNames": [
        "semantic-release",
        "@semantic-release/changelog",
        "@semantic-release/commit-analyzer",
        "@semantic-release/release-notes-generator",
        "@semantic-release/github",
        "@semantic-release/git",
        "conventional-changelog-conventionalcommits"
      ],
      "separateMajorMinor": true,
      "separateMultipleMajor": true
    },
    {
      "description": "Highlight major updates for semantic-release itself",
      "matchManagers": ["npm"],
      "matchPackageNames": ["semantic-release"],
      "matchUpdateTypes": ["major"],
      "labels": ["dependencies", "renovate", "breaking-release-tools"]
    }
  ],

  "regexManagers": [
    {
      "description": "Node.js versions in workflow files",
      "fileMatch": ["(^|.*/)\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": ["node-version:\\s*['\"]?(?<currentValue>[0-9.]+)['\"]?"],
      "datasourceTemplate": "node",
      "depNameTemplate": "node",
      "versioningTemplate": "node"
    },
    {
      "description": "Terraform versions in workflow files",
      "fileMatch": ["(^|.*/)\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": ["TERRAFORM_VERSION:\\s*\"(?<currentValue>[0-9.]+)\""],
      "datasourceTemplate": "terraform-version",
      "depNameTemplate": "hashicorp/terraform"
    },

    {
      "description": "ANSIBLE_CORE_VERSION in workflow env",
      "fileMatch": ["(^|.*/)ansible-collection/base/\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": [
        "ANSIBLE_CORE_VERSION:\\s*\"(?<currentValue>[0-9]+\\.[0-9]+\\.[0-9]+)\""
      ],
      "datasourceTemplate": "pypi",
      "packageNameTemplate": "ansible-core",
      "versioningTemplate": "pep440"
    },
    {
      "description": "ANSIBLE_LINT_VERSION in workflow env",
      "fileMatch": ["(^|.*/)ansible-collection/base/\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": [
        "ANSIBLE_LINT_VERSION:\\s*\"(?<currentValue>[0-9]+\\.[0-9]+\\.[0-9]+)\""
      ],
      "datasourceTemplate": "pypi",
      "packageNameTemplate": "ansible-lint",
      "versioningTemplate": "pep440"
    },

    {
      "description": "PYTHON_VERSION in workflow env",
      "fileMatch": ["(^|.*/)ansible-collection/base/\\.github/workflows/.*\\.ya?ml$"],
      "matchStrings": ["PYTHON_VERSION:\\s*\"(?<currentValue>[0-9.]+)\""],
      "datasourceTemplate": "python-version",
      "depNameTemplate": "python",
      "versioningTemplate": "python"
    },

    {
      "description": "wunder-devtools-ee image tag in scripts and workflows",
      "fileMatch": [
        "(^|.*/)scripts/.*\\.sh$",
        "(^|.*/)\\.github/workflows/.*\\.ya?ml$",
        "(^|.*/)\\.pre-commit-config\\.ya?ml$"
      ],
      "matchStrings": ["ghcr\\.io/lightning-it/wunder-devtools-ee:v(?<currentValue>[0-9.]+)"],
      "datasourceTemplate": "docker",
      "packageNameTemplate": "ghcr.io/lightning-it/wunder-devtools-ee"
    },
    {
      "description": "actionlint docker image in pre-commit and scripts",
      "fileMatch": ["(^|.*/)\\.pre-commit-config\\.ya?ml$", "(^|.*/)scripts/.*\\.sh$"],
      "matchStrings": ["docker\\.io/rhysd/actionlint:(?<currentValue>v?[0-9.]+)"],
      "datasourceTemplate": "docker",
      "packageNameTemplate": "rhysd/actionlint"
    },
    {
      "description": "Renovate docker image in pre-commit and scripts",
      "fileMatch": ["(^|.*/)\\.pre-commit-config\\.ya?ml$", "(^|.*/)scripts/.*\\.sh$"],
      "matchStrings": ["renovate/renovate:(?<currentValue>[0-9.]+)"],
      "datasourceTemplate": "docker",
      "packageNameTemplate": "renovate/renovate"
    },
    {
      "description": "Rocky Linux images in Molecule files",
      "fileMatch": ["(^|.*/)molecule/.*/molecule\\.ya?ml$"],
      "matchStrings": ["quay\\.io/rockylinux/rockylinux:(?<currentValue>[0-9.]+)"],
      "datasourceTemplate": "docker",
      "packageNameTemplate": "quay.io/rockylinux/rockylinux"
    }
  ]
}
